<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VÃ²ng Quay May Máº¯n</title>

<style>
*{
    margin:0;
    padding:0;
    box-sizing:border-box;
}

body{
    font-family:sans-serif;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    min-height:100vh;
    background:linear-gradient(180deg,#ff8c42,#d84315);
    overflow-x:hidden;
}

/* ===== TITLE ===== */
.title{
    margin-top:20px;
    font-size:clamp(22px,6vw,42px);
    color:white;
    font-weight:bold;
    text-align:center;
    text-shadow:0 0 10px gold;
}

/* ===== WHEEL CONTAINER ===== */
.wheel-container{
    position:relative;
    width:min(90vw,520px);
    aspect-ratio:1/1;
    margin-top:20px;
}

/* ===== CANVAS ===== */
canvas{
    width:100%;
    height:100%;
    border-radius:50%;
    box-shadow:0 0 40px gold;
    background:white;
}

/* ===== POINTER ===== */
.pointer{
    position:absolute;
    top:-28px;
    left:50%;
    transform:translateX(-50%);
    width:0;
    height:0;
    border-left:22px solid transparent;
    border-right:22px solid transparent;
    border-bottom:38px solid #ffd700;
    filter:drop-shadow(0 0 8px gold);
    z-index:10;
}

/* ===== BUTTON ===== */
button{
    margin-top:25px;
    padding:14px 40px;
    font-size:clamp(16px,4vw,22px);
    border:none;
    border-radius:40px;
    cursor:pointer;
    background:linear-gradient(45deg,#ffd700,#ff9800);
    font-weight:bold;
    box-shadow:0 6px 0 #cc7a00;
}

button:active{
    transform:translateY(6px);
    box-shadow:0 2px 0 #cc7a00;
}

/* ===== RESULT ===== */
.result{
    margin-top:20px;
    font-size:clamp(18px,5vw,26px);
    color:white;
    font-weight:bold;
    text-align:center;
    text-shadow:0 0 10px black;
}
</style>
</head>
<body>

<div class="title">ðŸ§§ VÃ’NG QUAY MAY Máº®N ðŸ§§</div>

<div class="wheel-container">
    <div class="pointer"></div>
    <canvas id="wheel"></canvas>
</div>

<button id="spinBtn">QUAY NGAY</button>
<div class="result" id="result"></div>

<script>
const canvas = document.getElementById("wheel");
const ctx = canvas.getContext("2d");
const spinBtn = document.getElementById("spinBtn");
const resultText = document.getElementById("result");

/* ===== RESPONSIVE CANVAS DPI FIX ===== */
function resizeCanvas(){
    const size = canvas.clientWidth;
    const dpr = window.devicePixelRatio || 1;
    canvas.width = size * dpr;
    canvas.height = size * dpr;
    ctx.setTransform(dpr,0,0,dpr,0,0);
    drawWheel(currentAngle);
}
window.addEventListener("resize", resizeCanvas);

/* ===== DATA ===== */
const segments = [
    "May máº¯n láº§n sau","2k",
    "May máº¯n láº§n sau","5k",
    "May máº¯n láº§n sau","10k",
    "May máº¯n láº§n sau","15k",
    "May máº¯n láº§n sau","20k",
    "2k","5k","10k","15k","20k"
];

const LUCKY = [0,2,4,6,8];
const MONEY = [1,3,5,7,9,10,11,12,13,14];

let total = segments.length;
let arc = 2*Math.PI/total;

let currentAngle = 0;
let spinning = false;

/* ===== DRAW WHEEL ===== */
function drawWheel(angle){
    const size = canvas.clientWidth;
    const center = size/2;
    const radius = center;

    ctx.clearRect(0,0,size,size);

    for(let i=0;i<total;i++){
        const start = angle + i*arc;

        ctx.beginPath();
        ctx.moveTo(center,center);
        ctx.arc(center,center,radius,start,start+arc);
        ctx.fillStyle = i%2===0 ? "#e53935" : "#fdd835";
        ctx.fill();

        ctx.strokeStyle="#fff";
        ctx.lineWidth=2;
        ctx.stroke();

        ctx.save();
        ctx.translate(center,center);
        ctx.rotate(start+arc/2);
        ctx.textAlign="right";
        ctx.fillStyle="#000";
        ctx.font="bold "+(size*0.04)+"px sans-serif";
        ctx.fillText(segments[i],radius-10,5);
        ctx.restore();
    }

    ctx.beginPath();
    ctx.arc(center,center,radius*0.08,0,2*Math.PI);
    ctx.fillStyle="gold";
    ctx.fill();
}

/* ===== 95% LOGIC ===== */
function getResultIndex(){
    let r = Math.random();
    if(r <= 0.75){
        return LUCKY[Math.floor(Math.random()*LUCKY.length)];
    }else{
        return MONEY[Math.floor(Math.random()*MONEY.length)];
    }
}

/* ===== SPIN ===== */
spinBtn.addEventListener("click",()=>{
    if(spinning) return;
    spinning=true;
    resultText.innerText="";

    const index = getResultIndex();
    const spins = 8;
    const baseRotation = spins*2*Math.PI;

    const target =
        baseRotation +
        (-Math.PI/2 - (index*arc + arc/2));

    const startAngle = currentAngle;
    const endAngle = target;

    let startTime=null;
    const duration=4500;

    function animate(time){
        if(!startTime) startTime=time;
        let progress=(time-startTime)/duration;
        if(progress>1) progress=1;

        let ease=1-Math.pow(1-progress,3);
        currentAngle = startAngle + (endAngle-startAngle)*ease;

        drawWheel(currentAngle);

        if(progress<1){
            requestAnimationFrame(animate);
        }else{
            spinning=false;

            if(segments[index]==="May máº¯n láº§n sau"){
                resultText.innerText="ðŸ€ ChÃºc báº¡n may máº¯n láº§n sau!";
            }else{
                resultText.innerText="ðŸŽ‰ Báº¡n nháº­n Ä‘Æ°á»£c: "+segments[index];
            }
        }
    }

    requestAnimationFrame(animate);
});

/* INIT */
resizeCanvas();
</script>

</body>
</html>
